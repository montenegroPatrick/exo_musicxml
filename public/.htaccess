<IfModule mod_rewrite.c>
  RewriteEngine On

  # Si la requête est pour un fichier ou dossier qui existe, le servir directement
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d

  # Sinon, rediriger vers index.html
  RewriteRule ^ index.html [L]
</IfModule>

# Allow iframe embedding from any domain
<IfModule mod_headers.c>
  # Remove X-Frame-Options to allow iframe embedding
  Header always unset X-Frame-Options

  # Allow all domains to embed this app in iframe
  Header always set Content-Security-Policy "frame-ancestors *"

  # Allow credentials for Flat.io API
  Header always set Access-Control-Allow-Credentials "true"
</IfModule>

# Si mod_rewrite n'est pas disponible, afficher une erreur
<IfModule !mod_rewrite.c>
  ErrorDocument 404 /index.html
</IfModule>

# Compression (optionnel mais recommandé)
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/css application/json application/javascript text/xml application/xml
</IfModule>

# Cache pour les assets (optionnel)
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
</IfModule>
